---
up:
  - "[[SpringBoot 課程描述]]"
---

# 自动配置原理

> [!NOTE]
> 
> **更多細節請看影片** 

1. 收集Spring开发者的编程习惯，整理开发过程使用的常用技术列表——>(技术集A)

2. 收集常用技术(技术集A)的使用参数，整理开发过程中每个技术的常用设置列表——>(设置集B)

3. 初始化SpringBoot基础环境，加载用户自定义的bean和导入的其他坐标，形成初始化环境

4. 将技术集A包含的所有技术都定义出来，在Spring/SpringBoot启动时默认全部加载

5. 将技术集A中具有使用条件的技术约定出来，设置成按条件加载，由开发者决定是否使用该技术（与初始化环境比对）

6. 将设置集B作为默认配置加载（约定大于配置），减少开发者配置工作量

7. 开放设置集B的配置覆盖接口，由开发者根据自身需要决定是否覆盖默认配置

---

# 变更自动配置


> [!NOTE] **注意事項**
> 
> - 使用 [[依赖属性配置]] 的程式碼
> - `Spring Boot 3.x` 不再透過 `META-INF/spring.factories` 的 `org.springframework.boot.autoconfigure.EnableAutoConfiguration` 條目來註冊自動配置，故如下範例使用 `Spring Boot 2.6.13` 版本做示範


### 自定义自动配置（META-INF/spring.factories）

```xml
# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\ \
  com.test.config.CartoonCatAndMouse
```

### 控制 SpringBoot 内置自动配置类加载

**方式一**

```yml
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration
      - org.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration
```

**方式二**

```java
@EnableAutoConfiguration(
	exclude = { 
		TaskExecutionAutoConfiguration.class, 
		LifecycleAutoConfiguration.class 
	}
)

// 或

@EnableAutoConfiguration(
  excludeName = {
	"org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration",
    "org.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration" 
  }
)
```